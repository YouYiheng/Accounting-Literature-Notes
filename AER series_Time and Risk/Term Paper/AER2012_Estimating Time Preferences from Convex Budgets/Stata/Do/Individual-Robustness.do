/***** Individual Robustness.do: Individual Anaylsis ********//* This do file can be called by doanaylsis.do and has 1 components. 1. Repeats individual analysis without varying restrictions to the background terms and various estimators*//*** Background Average Daily Consumption ***/capture drop alphaicapture drop betaicapture drop deltaicapture drop convergeicapture drop rateigen alphai = .gen betai = .gen deltai = .gen convergei = .gen ratei = .forvalues i = 1(1)97 {estimates clearreturn clearcapture drop gammarestrictegen gammarestrict = mean(-spendweek/7)qui capture nl (cons1= (((1 - (({beta=1}*{delta=1}^k)*(pratio))^(1/({alpha = 0.7} - 1)))*gammarestrict) + ((({beta=1}*{delta=1}^k)*(pratio))^(1/({alpha = 0.7} -1 )))*mnumer )/(( 1+ ((pratio)^({alpha = 0.7}/({alpha= 0.7} -1)))*(({beta=1}*{delta = 1}^k)^(1/({alpha= 0.7} -1 )) )))*t0     +       (((1 - (({delta=1}^k)*(pratio))^(1/({alpha = 0.7} - 1)))*gammarestrict) + ((({delta=1}^k)*(pratio))^(1/({alpha = 0.7} -1 )))*mnumer )/(( 1+ ((pratio)^({alpha = 0.7}/({alpha= 0.7} -1)))*(({delta = 1}^k)^(1/({alpha= 0.7} -1 )) )))*(1-t0)) if labnumber == `i',  iter(100)qui replace convergei = e(converge) if labnumber == `i'qui capture nlcom (yearrate: 1/_b[/delta]^365 - 1)  (beta:_b[/beta]) (alpha: _b[/alpha]) (delta: _b[/delta])matrix tempmat = r(b)qui replace ratei = tempmat[1,1] if labnumber == `i'qui replace betai = tempmat[1,2] if labnumber == `i'qui replace alphai = tempmat[1,3] if labnumber == `i'qui replace deltai = tempmat[1,4] if labnumber == `i'}log on/*** Appendix Table A3 With Average Background Consumption ****/local biglist "ratei deltai betai alphai"foreach x of local biglist {qui sum `x' if obscount == 1 & sdc != 0 & convergei == 1 &labnumber != 84, detdisp "`x'" " & " r(N) " & " round(r(p50), .0001) " & " round(r(p5), .0001) " & " round(r(p95), .0001) " & " round(r(min), .0001) " & " round(r(max), .0001) " \\"  }log off /*** Background Daily Consumption ***/capture drop alphaicapture drop betaicapture drop deltaicapture drop convergeicapture drop rateigen alphai = .gen betai = .gen deltai = .gen convergei = .gen ratei = .forvalues i = 1(1)97 {estimates clearreturn clearcapture drop gammarestrictqui gen gammarestrict = -spendweek/7qui capture nl (cons1= (((1 - (({beta=1}*{delta=1}^k)*(pratio))^(1/({alpha = 0.7} - 1)))*gammarestrict) + ((({beta=1}*{delta=1}^k)*(pratio))^(1/({alpha = 0.7} -1 )))*mnumer )/(( 1+ ((pratio)^({alpha = 0.7}/({alpha= 0.7} -1)))*(({beta=1}*{delta = 1}^k)^(1/({alpha= 0.7} -1 )) )))*t0     +       (((1 - (({delta=1}^k)*(pratio))^(1/({alpha = 0.7} - 1)))*gammarestrict) + ((({delta=1}^k)*(pratio))^(1/({alpha = 0.7} -1 )))*mnumer )/(( 1+ ((pratio)^({alpha = 0.7}/({alpha= 0.7} -1)))*(({delta = 1}^k)^(1/({alpha= 0.7} -1 )) )))*(1-t0)) if labnumber == `i',  iter(100)qui replace convergei = e(converge) if labnumber == `i'qui capture nlcom (yearrate: 1/_b[/delta]^365 - 1)  (beta:_b[/beta]) (alpha: _b[/alpha]) (delta: _b[/delta])matrix tempmat = r(b)qui replace ratei = tempmat[1,1] if labnumber == `i'qui replace betai = tempmat[1,2] if labnumber == `i'qui replace alphai = tempmat[1,3] if labnumber == `i'qui replace deltai = tempmat[1,4] if labnumber == `i'}log on/*** Appendix Table A5 With Own Background Consumption ****/local biglist "ratei deltai betai alphai"foreach x of local biglist {qui sum `x' if obscount == 1 & sdc != 0 & convergei == 1 &labnumber != 84 & spendweek != . , detdisp "`x'" " & " r(N) " & " round(r(p50), .0001) " & " round(r(p5), .0001) " & " round(r(p95), .0001) " & " round(r(min), .0001) " & " round(r(max), .0001) " \\"  }log off /*** Background Daily Consumption Tobit/OLS for totally censored guys ***/capture drop alphaicapture drop betaicapture drop deltaicapture drop convergeicapture drop rateigen alphai = .gen betai = .gen deltai = .gen ratei = .capture drop bgegen  bg = mean(spendweek/7)capture drop logcratio qui gen logcratio = log((cons1 + bg)/(cons2+bg))capture drop logpratioqui gen logpratio = log(pratio)capture drop tempgen temp = impatient - patientforvalues i = 1(1)97 {estimates clearreturn clearqui capture cnreg logcratio t0 logpratio k if labnumber == `i', nocons censored(temp)qui capture nlcom  (yearrate: 1/exp(_b[k]/(_b[logpratio]))^365 - 1) (beta: exp(_b[t0]/(_b[logpratio])))  (alpha: (1/(_b[logpratio])) + 1) (delta: exp(_b[k]/(_b[logpratio])))matrix tempmat = r(b)qui replace ratei = tempmat[1,1] if labnumber == `i'qui replace betai = tempmat[1,2] if labnumber == `i'qui replace alphai = tempmat[1,3] if labnumber == `i'qui replace deltai = tempmat[1,4] if labnumber == `i'qui capture reg logcratio t0 logpratio k if labnumber == `i', nocons qui capture nlcom  (yearrate: 1/exp(_b[k]/(_b[logpratio]))^365 - 1) (beta: exp(_b[t0]/(_b[logpratio])))  (alpha: (1/(_b[logpratio])) + 1) (delta: exp(_b[k]/(_b[logpratio])))matrix tempmat = r(b)qui replace ratei = tempmat[1,1] if labnumber == `i' & totinterior <=1 qui replace betai = tempmat[1,2] if labnumber == `i' & totinterior <=1qui replace alphai = tempmat[1,3] if labnumber == `i' & totinterior <=1qui replace deltai = tempmat[1,4] if labnumber == `i' & totinterior <=1}log on/*** Appendix Table  A4 With Average Background Consumption tobit ****/local biglist "ratei deltai betai alphai"foreach x of local biglist {qui sum `x' if obscount == 1 & sdc != 0 &labnumber != 84 , detdisp "`x'" " & " r(N) " & " round(r(p50), .0001) " & " round(r(p5), .0001) " & " round(r(p95), .0001) " & " round(r(min), .0001) " & " round(r(max), .0001) " \\"  }log off 