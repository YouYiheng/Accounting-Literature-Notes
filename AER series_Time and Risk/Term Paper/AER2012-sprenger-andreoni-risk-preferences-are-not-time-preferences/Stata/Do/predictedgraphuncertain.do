/* predictedgraphiuncertain.do *//* This do file produces three graphs:Graph 1: Average behavior in 50-50, 50-40 and 40-50 conditions along with model predictions from a twoparameter model. This is Figure 4 in the paper. Model predictions are hard-coded below and the code for generating them is available.Graph 2: Average behavior in 50-50, 50-40 and 40-50 conditions along with model predictions from a oneparameter model. This is Figure A1 in the paper.Graph 3: Average behavior in common ratio 100-80/50-40 and 80-100/40-50 conditions. This is figure 5 in the paper.*//* Model Predictions */capture drop conshatgen conshat = ./* First two condition model predictions are coming from numerical solutions*//* 10080 Risk Condition */replace conshat =  17.52219 if risk10080 == 1  & irate == 1  & k == 28replace conshat = 16.61334  if risk10080 == 1  & irate >1.05 & irate <1.06 & k == 28replace conshat = 15.68790  if risk10080 == 1  & irate >1.10 & irate <1.12 & k == 28replace conshat = 14.73489 if risk10080 == 1  & irate >1.17 & irate <1.18 & k == 28replace conshat = 13.73458   if risk10080 == 1  & irate == 1.25 & k == 28replace conshat = 12.65068  if risk10080 == 1  & irate >1.33 & irate <1.34 & k == 28replace conshat = 11.41430  if risk10080 == 1  & irate >1.42 & irate <1.43 & k == 28replace conshat = 17.53182 if risk10080 == 1  & irate == 1  & k == 56replace conshat = 16.62743   if risk10080 == 1  & irate >1.05 & irate <1.06 & k == 56replace conshat = 15.70895  if risk10080 == 1  & irate >1.10 & irate <1.12 & k == 56replace conshat = 14.76708 if risk10080 == 1  & irate >1.17 & irate <1.18 & k == 56replace conshat = 13.78499  if risk10080 == 1  & irate == 1.25 & k == 56replace conshat = 12.73181  if risk10080 == 1  & irate >1.33 & irate <1.34 & k == 56replace conshat =  11.54870 if risk10080 == 1  & irate >1.42 & irate <1.43 & k == 56/* 80100 Risk Condition */replace conshat = 2.502519 if risk80100 == 1  & irate == 1  & k == 28replace conshat = 2.471062 if risk80100 == 1  & irate >1.05 & irate <1.06 & k == 28replace conshat = 2.449949 if risk80100 == 1  & irate >1.10 & irate <1.12 & k == 28replace conshat = 2.436074 if risk80100 == 1  & irate >1.17 & irate <1.18 & k == 28replace conshat = 2.427200 if risk80100 == 1  & irate == 1.25 & k == 28replace conshat = 2.421625 if risk80100 == 1  & irate >1.33 & irate <1.34 & k == 28replace conshat = 2.418242 if risk80100 == 1  & irate >1.42 & irate <1.43 & k == 28replace conshat = 2.518245 if risk80100 == 1  & irate == 1  & k == 56replace conshat = 2.481223 if risk80100 == 1  & irate >1.05 & irate <1.06 & k == 56replace conshat = 2.456339 if risk80100 == 1  & irate >1.10 & irate <1.12 & k == 56replace conshat = 2.440005 if risk80100 == 1  & irate >1.17 & irate <1.18 & k == 56replace conshat = 2.429516 if risk80100 == 1  & irate == 1.25 & k == 56replace conshat = 2.422983 if risk80100 == 1  & irate >1.33 & irate <1.34 & k == 56replace conshat = 2.419039 if risk80100 == 1  & irate >1.42 & irate <1.43 & k == 56capture drop deltarestrictgen deltarestrict =    .9993161 capture drop gammarestrictgen gammarestrict =     2.414154 nl (cons1= (((1 - ((deltarestrict^k)*(theta))^(1/({alpha = 0.7} - 1)))*gammarestrict) + (((deltarestrict^k)*(theta))^(1/({alpha = 0.7} -1 )))*mnumer )      /(1 + irate*(theta*deltarestrict^k)^(1/({alpha=0.7} -1)))) if risk5050==1 , clu(labnumber)capture drop temppredict temp if risk5050==1 | risk4050 == 1 | risk5040 == 1replace conshat = temp if risk5050==1 | risk4050 == 1 | risk5040 == 1/* Builde up separate R-squared */capture drop tssinegen tssin = total(cons1^2) if risk5050 == 1capture drop tssoutegen tssout = total(cons1^2) if risk5040 == 1 | risk4050 == 1capture drop tss5040egen tss5040 = total(cons1^2) if risk5040 == 1 capture drop tss4050egen tss4050 = total(cons1^2) if risk4050 == 1 capture drop ssrinegen ssrin = total((cons1-conshat)^2) if risk5050 == 1capture drop ssroutegen ssrout = total((cons1-conshat)^2) if risk5040 == 1 | risk4050 == 1capture drop ssr5040egen ssr5040 = total((cons1-conshat)^2) if risk5040 == 1 capture drop ssr4050egen ssr4050 = total((cons1-conshat)^2) if risk4050 == 1 capture drop rsqingen rsqin = (tssin - ssrin)/tssincapture drop rsqoutgen rsqout = (tssout - ssrout)/tssoutcapture drop rsq5040gen rsq5040 = (tss5040- ssr5040)/tss5040capture drop rsq4050gen rsq4050 = (tss4050- ssr4050)/tss4050/* Build Graph 1 */twoway  (rcap avgcons1hi avgcons1low theta if risk5050 == 1| risk5040==1 | risk4050==1, color(black) sort) (connected avgcons1 theta if risk5050 == 1, color(red) sort lpattern(dash)) (connected avgcons1 theta if risk5040 == 1, color(green)  lpattern(dash) sort) (connected avgcons1 theta if risk4050==1,  color(orange)  lpattern(dash) sort) (line conshat theta if risk5050 == 1, color(red) sort) (line conshat theta if risk5040 == 1, color(green) sort) (line conshat theta if risk4050 == 1, color(orange) sort)  if labnumber == 1 , ytitle("Mean Earlier Choice ($)") ylabel(0(5)20, angle(horizontal)) xtitle("Theta (1+r)(p2/p1)")  by(, legend(on)) legend(order(2 "(p1,p2) = (0.5,0.5)"  3 "(p1,p2) = (0.5,0.4)"  4 "(p1,p2) = (0.4,0.5)" 5 "(0.5,0.5) Fit" "R-Squared = 0.761" 6 "(0.5,0.4) Prediction" "R-Squared = 0.878" 7 "(0.4,0.5) Prediction"  "R-Squared = 0.580" 1 "+/- 1.96 S.E." ) cols(3)  size(vsmall)) by(k) xlabel(0.8(0.2)1.8)  scheme(s1mono)graph export "Figures/riskygraphgood.pdf", replacelog onsu rsq5040 rsq4050nl (cons1= (((1 - (({delta=1}^k)*(theta))^(1/({alpha = 0.7} - 1)))*{gamma=1}) + ((({delta=1}^k)*(theta))^(1/({alpha = 0.7} -1 )))*mnumer )      /(1 + irate*(theta*{delta=1}^k)^(1/({alpha=0.7} -1)))) if risk100100 == 1 | risk5050==1, clu(labnumber)nlcom (alpha: _b[/alpha]) (yearrate: 1/_b[/delta]^365-1) (omega: _b[/gamma]), postlog off/* Graph 2 *//* Model Prediction*/capture drop deltarestrictgen deltarestrict =    .9993161 capture drop gammarestrictgen gammarestrict =     2.414154 nl (cons1= (((1 - ((deltarestrict^k)*(theta))^(1/({alpha = 0.7} - 1)))*gammarestrict) + (((deltarestrict^k)*(theta))^(1/({alpha = 0.7} -1 )))*mnumer )      /(1 + irate*(theta*deltarestrict^k)^(1/({alpha=0.7} -1)))) if risk100100==1 , clu(labnumber)capture drop conshat2predict conshat2 if risk5050==1 | risk4050 == 1 | risk5040 == 1capture drop ssr5040egen ssr5040 = total((cons1-conshat2)^2) if risk5040 == 1 capture drop ssr4050egen ssr4050 = total((cons1-conshat2)^2) if risk4050 == 1 capture drop rsq5040gen rsq5040 = (tss5040- ssr5040)/tss5040capture drop rsq4050gen rsq4050 = (tss4050- ssr4050)/tss4050/* Build Graph 2 */twoway  (rcap avgcons1hi avgcons1low theta if risk5050 == 1| risk5040==1 | risk4050==1, color(black) sort) (connected avgcons1 theta if risk5050 == 1, color(red) sort lpattern(dash)) (connected avgcons1 theta if risk5040 == 1, color(green)  lpattern(dash) sort) (connected avgcons1 theta if risk4050==1,  color(orange)  lpattern(dash) sort)  (line conshat2 theta if risk5040 == 1, color(blue) sort)  (line conshat2 theta if risk4050 == 1, color(blue) sort)   if labnumber == 1 , ytitle("Mean Earlier Choice ($)") ylabel(0(5)20, angle(horizontal)) xtitle("Theta (1+r)(p2/p1)")  by(, legend(on)) legend(order(2 "(p1,p2) = (0.5,0.5)"  3 "(p1,p2) = (0.5,0.4)"  4 "(p1,p2) = (0.4,0.5)"  5 "(1,1) prediction" 1 "+/- 1.96 S.E." ) cols(3)  size(vsmall)) by(k) xlabel(0.8(0.2)1.8)  scheme(s1mono)graph export "Figures/riskygraphbad.pdf", replacelog onsu rsq5040 rsq4050log off/* Graph 3 */twoway  (rcap avgcons1hi avgcons1low theta if risk10080 == 1|risk80100 == 1|  risk5040==1 | risk4050==1, color(black) sort) (connected avgcons1 theta if risk10080 == 1, color(gray) sort lpattern(dash)) (connected avgcons1 theta if risk80100 == 1, color(purple) sort lpattern(dash)) (connected avgcons1 theta if risk5040 == 1, color(green)  lpattern(dash) sort) (connected avgcons1 theta if risk4050==1,  color(orange)  lpattern(dash) sort) if labnumber == 1 , ytitle("Mean Earlier Choice ($)") ylabel(0(5)20, angle(horizontal)) xtitle("Theta (1+r)(p2/p1)")  by(, legend(on)) legend(order(4 "(p1,p2) = (0.5,0.4)"  5 "(p1,p2) = (0.4,0.5)"  1 "+/- 1.96 S.E." 2 "(p1,p2) = (1,0.8)" 3 "(p1,p2) = (0.8,1)"   ) cols(3)  size(vsmall)) by(k) xlabel(0.8(0.2)1.8)  scheme(s1mono)graph export "Figures/certpref.pdf", replace